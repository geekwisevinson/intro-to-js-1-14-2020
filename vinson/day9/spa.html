<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spa</title>
</head>
<body>



<script>

    /*
    1. any prop update should have a function
    2. any calc should have have a function that returns
    * */

    loadPage('home');

    function getTextFromFile(type, file) {
        return fetch(`./${type}/${file}.html`)
            .then( res => { return res.text() });
    }
    function loadPage(file) {
        return getTextFromFile('pages', file).then( res => {
                updateHtml(document.body, res);
                checkForComponents(document.body);
            });
    }
    function loadComponent(file) {
        return getTextFromFile('components', file);
    }
    function checkForComponents(el) {
        const components = el.querySelectorAll('[data-component]');
        components.forEach( component => {
            const componentName = component.getAttribute('data-component');
            const models = JSON.parse(component.getAttribute('data-models'));
            console.log(componentName, models);
            loadComponent(componentName).then( text => {
                for (let prop in models) {
                    component.innerHTML = replaceText(text, prop, models[prop]);
                }

            });
        })
    }

    function replaceText(string, textToReplace, textWeWant) {
        return string.replace(textToReplace, textWeWant)
    }
    function updateHtml(el, text) {
        el.innerHTML = text;
    }
</script>

</body>
</html>
